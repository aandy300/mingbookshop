"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[900],{4900:function(t,e,s){s.r(e),s.d(e,{default:function(){return lt}});var a=s(6252),i=s(3577),c=s(9963);const o={class:"container d-flex flex-column justify-content-center align-items-center",style:{"min-height":"100vh"}},n={key:0,class:"row col-12"},l={key:0,class:"d-flex justify-content-center my-5"},d={class:"col-md-6 border border-dark text-center"},r={class:"card-body"},u=(0,a._)("strong",null,[(0,a._)("p",{class:"m-0 text-primary",style:{"font-size":"2rem"}},"購物車目前沒有東西")],-1),p=(0,a._)("button",{type:"button",class:"col-4 btn btn-outline-primary mt-2"},"前去購買",-1),m={key:1,class:"row d-flex flex-nowrap justify-content-center align-items-center"},g=(0,a.uE)('<div style="max-width:18rem;" class="col-3 d-none d-sm-block text-white bg-secondary my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center"><i class="bi bi-dash-circle-dotted mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step1</p><p class="card-text text-center mb-2">確認訂單</p></div></div><div style="max-width:18rem;" class="col-3 d-none d-sm-block text-balck bg-info my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center"><i class="bi bi-dash-circle-dotted mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step2</p><p class="card-text text-center mb-2">建立訂單</p></div></div><div style="max-width:18rem;" class="col-3 d-none d-sm-block text-balck bg-info my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center"><i class="bi bi-dash-circle-dotted mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step3</p><p class="card-text text-center mb-2">付款</p></div></div><div style="max-width:18rem;" class="col-10 d-flex align-items-center d-block d-sm-none text-balck bg-info my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center col-12"><i class="bi bi-dash-circle-dotted mt-2 text-center" style="font-size:40px;"></i><p class="card-text text-center m-0">Step1</p><p class="card-text text-center mb-2">確認訂單</p></div></div>',4),h=[g],x={key:2,class:"row"},f={class:"col-xl-12"},y={class:"d-flex justify-content-between mb-2"},b=(0,a._)("h4",null,"訂單內容",-1),v={class:"text-end"},w={class:"table align-middle"},_=(0,a._)("thead",{class:""},[(0,a._)("tr",{class:"col-12"},[(0,a._)("th",{style:{width:"40px"}}),(0,a._)("th",{class:"text-nowrap text-center d-none d-sm-block"},"圖片"),(0,a._)("th",{class:"text-center",style:{width:"40%"}},"品名"),(0,a._)("th",{class:"text-nowrap text-center",style:{width:"20%"}},"數量/單位"),(0,a._)("th",{class:"text-center",style:{width:"10%"},nowrap:"nowrap"},"小計")])],-1),k=["onClick","disabled"],C={class:"d-none d-sm-block"},D={style:{},class:"figure d-flex flex-column justify-content-center align-items-center position-relative pt-3"},$=["src"],I=["src"],j={class:"text-center"},z={style:{},class:"figure d-flex flex-column justify-content-center align-items-center position-relative pt-3 d-block d-sm-none"},A=["src"],U=["src"],q={class:"input-group input-group-sm"},L={class:"input-group mb-3"},E=["onUpdate:modelValue","onChange","disabled"],O=["value"],Z={class:"input-group-text mt-3",id:"basic-addon2"},K={nowrap:"nowrap",class:"text-end"},S={class:"d-flex flex-column"},W={class:"d-flex justify-content-between"},V=(0,a._)("p",null,"套用優惠卷:2022BOOK",-1),B={key:0,class:"fs-4"},H={key:1,class:"fs-4"},Y={class:"d-flex justify-content-center align-items-center"},F={class:"input-group mb-2",style:{width:"50%"}},M=["disabled"],G={key:0},J={key:1},N={class:"d-flex justify-content-end align-items-center",style:{width:"50%"}},P={key:0,class:"fs-2 m-0"},Q={key:1},R={class:"d-flex flex-column justify-content-center align-items-center mt-2"},T={key:0},X={key:1},tt={key:2},et={key:3},st=(0,a._)("button",{type:"submit",class:"col-12 col-md-8 btn btn-primary"},"確認訂單",-1);function at(t,e,s,g,at,it){const ct=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",o,[!0===at.ready?((0,a.wg)(),(0,a.iD)("div",n,[0===at.cartData.carts.length?((0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",d,[(0,a._)("div",r,[u,(0,a.Wm)(ct,{to:"/products"},{default:(0,a.w5)((()=>[p])),_:1})])])])):((0,a.wg)(),(0,a.iD)("div",m,h)),at.cartData.carts.length>0?((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("div",f,[(0,a._)("div",y,[b,(0,a._)("div",v,[(0,a._)("button",{type:"button",onClick:e[0]||(e[0]=(...t)=>it.removeAllCartItem&&it.removeAllCartItem(...t)),class:(0,i.C_)([{disabled:0===at.cartData.carts.length},"btn btn-outline-primary"])},"清空購物車",2)])]),(0,a._)("table",w,[_,(0,a._)("tbody",null,[at.cartData.carts?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(at.cartData.carts,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,[(0,a._)("button",{onClick:e=>it.removeCartItem(t.id),disabled:at.isLoadingItem===t.id,type:"button",class:"btn btn-outline-danger btn-sm px-2 py-1"}," x ",8,k)]),(0,a._)("td",C,[(0,a._)("figure",D,[(0,a.Wm)(ct,{style:{"text-decoration":"none"},to:`/product/${t.product.id}`},{default:(0,a.w5)((()=>[(0,a._)("img",{style:{height:"150px"},src:t.product.imageUrl,alt:"",class:"figure-img img-fluid rounded d-none d-md-block"},null,8,$),(0,a._)("img",{style:{},src:t.product.imageUrl,alt:"",class:"figure-img img-fluid rounded d-block d-md-none"},null,8,I)])),_:2},1032,["to"])])]),(0,a._)("td",j,[(0,a._)("figure",z,[(0,a.Wm)(ct,{style:{"text-decoration":"none"},to:`/product/${t.product.id}`},{default:(0,a.w5)((()=>[(0,a._)("img",{style:{height:"150px"},src:t.product.imageUrl,alt:"",class:"figure-img img-fluid rounded d-none d-md-block"},null,8,A),(0,a._)("img",{style:{height:"100px"},src:t.product.imageUrl,alt:"",class:"figure-img img-fluid rounded d-block d-md-none"},null,8,U)])),_:2},1032,["to"])]),(0,a.Uk)(" "+(0,i.zw)(t.product.title),1)]),(0,a._)("td",null,[(0,a._)("div",q,[(0,a._)("div",L,[(0,a.wy)((0,a._)("select",{id:"",class:"form-select mt-3","onUpdate:modelValue":e=>t.qty=e,onChange:e=>it.updataCartItem(t),disabled:at.isLoadingItem===t.id},[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(e=>(0,a._)("option",{value:e,key:`${e} + ${t.id}`},(0,i.zw)(e),9,O))),64))],40,E),[[c.bM,t.qty]]),(0,a._)("span",Z,(0,i.zw)(t.product.unit),1)])])]),(0,a._)("td",K," $ "+(0,i.zw)(t.total),1)])))),128)):(0,a.kq)("",!0)])]),(0,a._)("div",S,[(0,a._)("div",W,[V,at.couponActive?((0,a.wg)(),(0,a.iD)("p",B,[(0,a._)("del",null,"總計: $ "+(0,i.zw)(at.cartData.total),1)])):((0,a.wg)(),(0,a.iD)("p",H,"總計: $ "+(0,i.zw)(at.cartData.total),1))]),(0,a._)("div",Y,[(0,a._)("div",F,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠券號碼","onUpdate:modelValue":e[1]||(e[1]=t=>at.couponCode=t)},null,512),[[c.nr,at.couponCode]]),(0,a._)("button",{class:"btn btn-outline-success",type:"button",disabled:at.couponActive,onClick:e[2]||(e[2]=(...t)=>it.useCoupon&&it.useCoupon(...t))},[at.couponActive?((0,a.wg)(),(0,a.iD)("span",G,"已套用")):((0,a.wg)(),(0,a.iD)("span",J,"使用"))],8,M)]),(0,a._)("div",N,[at.couponActive?((0,a.wg)(),(0,a.iD)("p",P,"總計: $ "+(0,i.zw)(at.cartData.final_total),1)):((0,a.wg)(),(0,a.iD)("p",Q))])])]),(0,a._)("div",R,[at.couponActive?((0,a.wg)(),(0,a.iD)("p",X,"以套用優惠卷")):((0,a.wg)(),(0,a.iD)("p",T)),at.couponErr?((0,a.wg)(),(0,a.iD)("p",tt,"優惠卷無效，請輸入正確的優惠卷。")):((0,a.wg)(),(0,a.iD)("p",et))]),(0,a.Wm)(ct,{class:"d-flex justify-content-center mb-4",to:"/createorder"},{default:(0,a.w5)((()=>[st])),_:1})])])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)])}var it=s(4902),ct={data(){return{ready:!1,cartData:{carts:[]},products:[],productsID:"",isLoadingItem:"",couponCode:"2022BOOK",couponActive:!1,couponErr:!1}},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ming123/cart").then((t=>{t.data.data.total===t.data.data.final_total?this.couponActive=!1:this.couponActive=!0,this.cartData=t.data.data,this.ready=!0})).catch((t=>{alert(t.data.message)}))},updataCartItem(t){const e={product_id:t.id,qty:t.qty};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ming123/cart/${t.id}`,{data:e}).then((()=>{this.getCart(),this.isLoadingItem="",it.Z.emit("get-cart",(()=>{this.getCart()}))})).catch((t=>{console.dir(t.data.message),alert(t.data.message)}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ming123/cart/${t}`).then((t=>{this.getCart(),it.Z.emit("get-cart",(()=>{this.getCart()})),this.isLoadingItem=""})).catch((t=>{alert(t.data.message)}))},removeAllCartItem(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/ming123/carts").then((t=>{this.getCart(),it.Z.emit("get-cart",(()=>{this.getCart()}))})).catch((t=>{alert(t.data.message)}))},useCoupon(){const t={code:this.couponCode};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ming123/coupon",{data:t}).then((()=>{this.couponActive=!0,this.couponErr=!1})).catch((t=>{this.couponErr=!0,console.log("useCoupon",t.response.data.message),console.dir("useCoupon",t.response.data.message)}))},createOrder(){const t=this.form;this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ming123/order",{data:t}).then((t=>{this.$refs.form.resetForm(),this.getCart(),this.form.message="",it.Z.emit("get-cart",(()=>{this.getCart()})),this.$router.push(`/pay/${t.data.orderId}`)}))}},mounted(){this.getCart()}},ot=s(3744);const nt=(0,ot.Z)(ct,[["render",at]]);var lt=nt}}]);
//# sourceMappingURL=900.1d3a62ab.js.map